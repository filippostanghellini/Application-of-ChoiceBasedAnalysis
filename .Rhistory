setwd("~/GitHub/Application-of-ChoiceBasedAnalysis")
# load library for fitting multinomial logit models
library(dfidx)
library(mlogit)
# import the data about the choice_data Survey for conjoint analysis
choice_data <- read.csv("data/Choice_Data_Converted.csv", sep=";")
head(choice_data)
# see some descriptive statistics
summary(choice_data)
xtabs(choice ~ spec, data=choice_data)
xtabs(choice ~ vel, data=choice_data)
xtabs(choice ~ qual, data=choice_data)
xtabs(choice ~ priv, data=choice_data)
xtabs(choice ~ cost, data=choice_data)
# recode some variables
choice_data$spec <- factor(choice_data$spec, levels=c("Assistente","Codice","Content")) # change order of categories
choice_data$vel <- factor(choice_data$vel, levels=c("Lento","Veloce")) # change order of categories
choice_data$qual <- factor(choice_data$qual, levels=c("Ottimale","Sufficente")) # change order of categories
choice_data$priv <- factor(choice_data$priv, levels=c("Bassa","Alta")) # change order of categories
choice_data$cost <- as.factor(choice_data$cost) # convert the variable as qualitative
# 1) Crea l'ID della situazione di scelta (una sola riga extra)
choice_data$choice_id <- with(choice_data, paste(resp.id, ques, sep = "_"))
# 2) QUI la riga che mi chiedi: chiamata a dfidx
choice_data.mlogit <- dfidx(
choice_data,
idx    = list(c("choice_id", "resp.id"), "alt"),
choice = "choice",
shape  = "long"
)
m1 <- mlogit(choice ~ spec + vel + qual + priv + cost, data = choice_data.mlogit)
summary(m1)
# Fit the model without intercept parameters
m2 <- mlogit(choice ~ spec + vel + qual + priv + cost | -1, data = choice_data.mlogit)
summary(m2)
# Test the restriction on the intercepts by comparing the two models
# through a likelihood ratio test
lrtest(m2, m1)
View(choice_data)
# Fit the model without intercept parameters and with price as a quantitative variable
m3 <- mlogit(choice ~ spec + vel + qual + priv
+ as.numeric(as.character(cost)) | -1, data = choice_data.mlogit)
summary(m3)
lrtest(m3, m2)
# Compute the willingness to pay for privacy alta
coef(m3)["privAlta"]/(coef(m3)["as.numeric(as.character(cost))"]/1000)
# Compute the willingness to pay for privacy alta
coef(m3)["privAlta"]/(coef(m3)["as.numeric(as.character(cost))"])
View(choice_data)
#WTP
coef(m3)["specCodice"]/(coef(m3)["as.numeric(as.character(cost))"])
coef(m3)["specContent"]/(coef(m3)["as.numeric(as.character(cost))"])
#WTP quality
coef(m3)["qualSufficiente"]/(coef(m3)["as.numeric(as.character(cost))"])
#WTP quality
coef(m3)["qualSufficente"]/(coef(m3)["as.numeric(as.character(cost))"])
#WTP veloce
coef(m3)["specVeloce"]/(coef(m3)["as.numeric(as.character(cost))"])
#WTP veloce
coef(m3)["velVeloce"]/(coef(m3)["as.numeric(as.character(cost))"])
(coef(m3)["as.numeric(as.character(cost))"])
coef(m3)["qualSufficente"]
#WTP quality
coef(m3)["qualSufficente"]/(coef(m3)["as.numeric(as.character(cost))"])
# Compute the willingness to pay for privacy alta
#WTP privacy
coef(m3)["privAlta"]/(coef(m3)["as.numeric(as.character(cost))"])
#WTP codice
coef(m3)["specCodice"]/(coef(m3)["as.numeric(as.character(cost))"])
#WTP content
coef(m3)["specContent"]/(coef(m3)["as.numeric(as.character(cost))"])
#WTP veloce
coef(m3)["velVeloce"]/(coef(m3)["as.numeric(as.character(cost))"])
#WTP quality
coef(m3)["qualSufficente"]/(coef(m3)["as.numeric(as.character(cost))"])
# Compute the willingness to pay for privacy alta
#WTP privacy
coef(m3)["privAlta"]/(coef(m3)["as.numeric(as.character(cost))"])
